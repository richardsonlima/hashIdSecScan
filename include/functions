#!/bin/sh

# Include
source include/constants

##############################################
# Name            :
# Description     :
# Returns         :
##############################################
CheckUmask(){

  if [ $? -eq 0 ]; then
       echo "Usually servers can have a more strict umask like (027), where desktops may be less strict (022)."
       echo -e "${OK} [*] Setting umask: ${NORMAL}"; umask $UMASK_OPTION && echo $UMASK_OPTION
     else
       echo -e "${WARNNING} [x] Could not set umask ${NORMAL}"
  fi
}

##############################################
# Name            :
# Description     :
# Returns         :
##############################################
MyUser(){
  IM=`whoami`
  if [ "${IM}" = "" ]; then
      echo -e "${WARNNING} [x] Could  not determine user ${NORMAL}"
  fi
  if [ "${IM}" = "root" ]; then
      echo -e "${WARNNING} [x] This programm should not be executed as root ${NORMAL}"
  fi
}

##############################################
# Name            :
# Description     :
# Returns         :
##############################################
BuildDir(){
  BUILDDIR="/opt/hashId-SecScan"
  if [ ! -d ${BUILDDIR} ]; then
      echo -e "${WARNNING} [x] Directory ${BUILDDIR} not found ${NORMAL}"
      echo -e "${WARNNING} Hint:  Missing directory, creating ${BUILDDIR} ${NORMAL}";sudo mkdir -p ${BUILDDIR}
    else
      echo -e "${NOTICE} [+] BuildDir found: ${BUILDDIR} ${NORMAL}"
  fi
}

##############################################
# Name            :
# Description     :
# Returns         :
##############################################
NeedsDir(){
  NEEDSDIR="build db main main/tmp include"
  for DIR in ${NEEDSDIR}; do
      if [ ! -d "${BUILDDIR}/${DIR}" ]; then
           echo -e "${WARNNING} [x] Missing directory, creating ${BUILDDIR}/${DIR}  ${NORMAL}";sudo mkdir -p ${BUILDDIR}/${DIR}
        else
          echo -e "${OK} [+] SubBuildDir found: ${BUILDDIR}/${DIR} ${NORMAL}"
      fi
  done
}

##############################################
# Name            :
# Description     :
# Returns         :
##############################################
Env(){
      FILES01="${BUILDDIR}/include/functions"
      #FILES02="${BUILDDIR}/include/constants"
      if [ ! -f "${FILES01}" ]; then
           echo -e "${WARNNING} [x] Include files not found in include directory, creating files in ${BUILDDIR}/include ${NORMAL}";sudo cp -Rfa include/{constants,functions} ${BUILDDIR}/include/
           echo -e "${NOTICE} [x] Creating alias in user environment ... ${NORMAL}";sudo echo "alias hashidsecscan='/opt/hashId-SecScan/hashidsecscan.sh' " >> ~/.bash_alias
           echo -e "${NOTICE} [x] Enabling alias in user environment ... ${NORMAL}";source ~/.bash_alias
        else
          echo -e "${OK} [+] Files found in include directory: ${BUILDDIR}/include ${NORMAL}"
      fi
}
